<!DOCTYPE html>
<html>
<head>
    <title>Ultra Accurate Image Marker Map</title>
    <meta name="viewport" content="initial-scale=1, width=device-width">

    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

    <style>
        #map { height: 500px; width: 100%; }
        #zoomBox {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 9999;
            background: white;
            padding: 5px 12px;
            border: 1px solid #000;
        }
        body { font-family: Arial; padding: 10px; }
        .info { margin-top: 10px; font-size: 18px; }
        .label { font-weight: bold; }
    </style>
</head>

<body>

<div id="zoomBox">Zoom: 100%</div>
<div id="map"></div>

<div class="info"><span class="label">City:</span> <span id="city">None</span></div>
<div class="info"><span class="label">State:</span> <span id="state">None</span></div>
<div class="info"><span class="label">Country:</span> <span id="country">None</span></div>
<div class="info"><span class="label">Landmark:</span> <span id="landmark">None</span></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
    // -----------------------------
    // MAP INITIALIZATION
    // -----------------------------
    var map = L.map("map", { zoomSnap: 0.1 }).setView([20.59, 78.96], 5);

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", { maxZoom: 19 })
    .addTo(map);

    var clickMarker = null;

    // -----------------------------
    // ðŸ”¥ GOOGLE-LEVEL ACCURACY (MapTiler API)
    // -----------------------------
    const API_KEY = "KkZ2QHYG4u2P4p3HRxqO";


    // -----------------------------
    // ðŸ”¥ FUNCTION TO ADD IMAGE MARKERS
    // -----------------------------
    function addImageMarker(lat, lng, imgURL, minZoom = 13) {

        let icon = L.icon({
            iconUrl: imgURL,
            iconSize: [45, 45],
            iconAnchor: [22, 45]
        });

        let marker = null;

        function updateVisibility() {
            if (map.getZoom() >= minZoom) {
                if (!marker) marker = L.marker([lat, lng], { icon: icon }).addTo(map);
            } else {
                if (marker) { map.removeLayer(marker); marker = null; }
            }
        }

        map.on("zoomend", updateVisibility);
        updateVisibility();
    }


    // -----------------------------
    // ðŸ”¥ ADD YOUR FIXED IMAGE MARKERS HERE
    // -----------------------------
    // Example 1 â†’ Delhi = chest icon
    addImageMarker(28.6139, 77.2090, "1.jpg", 13);

    // Example 2 â†’ Mumbai = devil image
    addImageMarker(19.0760, 72.8777, "2.jpg", 14);

    // You can add unlimited markers like this:
    // addImageMarker(LAT, LNG, "IMAGE_URL", MIN_ZOOM);


    // -----------------------------
    // ðŸ”µ CLICK â†’ BLUE PIN + LOCATION DETAILS
    // -----------------------------
    map.on("click", function(e) {
        var lat = e.latlng.lat;
        var lng = e.latlng.lng;

        if (clickMarker) map.removeLayer(clickMarker);
        clickMarker = L.marker([lat, lng]).addTo(map);

        let url = `https://api.maptiler.com/geocoding/${lng},${lat}.json?key=${API_KEY}`;

        fetch(url)
            .then(r => r.json())
            .then(d => {
                if (!d.features.length) return;

                let props = d.features[0].properties;

                document.getElementById("city").innerText =
                    props.locality || props.city || props.town || "Not Found";

                document.getElementById("state").innerText =
                    props.region || "Not Found";

                document.getElementById("country").innerText =
                    props.country || "Not Found";

                document.getElementById("landmark").innerText =
                    props.name || props.street || props.neighbourhood || "Not Found";
            });
    });


    // -----------------------------
    // ðŸ” ZOOM PERCENT BOX
    // -----------------------------
    map.on("zoomend", () => {
        let pct = Math.round((map.getZoom() / 13) * 200);
        document.getElementById("zoomBox").innerText = "Zoom: " + pct + "%";
    });
</script>

</body>
</html>